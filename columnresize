Private beamMoving As Integer

    Private Sub TableLayoutPanel1_MouseMove(sender As Object, e As MouseEventArgs) Handles TableLayoutPanel1.MouseMove
        Me.Cursor = Cursors.VSplit
        If (e.Button = System.Windows.Forms.MouseButtons.Left) Then
            Dim beam0 As Integer
            Dim beam1 As Integer
            beam0 = CInt(TableLayoutPanel1.ColumnStyles(0).Width)
            beam1 = CInt(TableLayoutPanel1.ColumnStyles(0).Width) + CInt(TableLayoutPanel1.ColumnStyles(1).Width)
            Select Case beamMoving
                Case 0
                    If (e.X > 0) Then
                        TableLayoutPanel1.ColumnStyles(0).Width = e.X
                    End If
                Case 1
                    If (e.X - beam0 > 0) Then
                        TableLayoutPanel1.ColumnStyles(1).Width = e.X - beam0
                    End If
            End Select
        End If
    End Sub

    Private Sub TableLayoutPanel1_MouseDown(sender As Object, e As MouseEventArgs) Handles TableLayoutPanel1.MouseDown
        Dim beam0 As Integer
        Dim beam1 As Integer
        beam0 = CInt(TableLayoutPanel1.ColumnStyles(0).Width)
        beam1 = CInt(TableLayoutPanel1.ColumnStyles(0).Width) + CInt(TableLayoutPanel1.ColumnStyles(1).Width)
        If (e.X + 20 > beam0 And e.X - 20 < beam1) Then
            beamMoving = 0
        End If
        If (e.X + 20 > beam1 And e.X - 20 < TableLayoutPanel1.Width) Then
            beamMoving = 1
        End If
    End Sub
